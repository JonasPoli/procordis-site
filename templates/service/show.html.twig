{% extends 'base_public.html.twig' %}

{% block title %}{{ service.title }} - Procordis{% endblock %}

{% block seo_schema %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "MedicalProcedure",
  "name": "{{ service.title }}",
  "description": "{{ service.description|default(service.title)|e('js') }}",
  "image": [
    {% if service.imageName %}
    "{{ app.request.schemeAndHttpHost ~ vich_uploader_asset(service, 'imageFile') }}"
    {% endif %}
  ],
  "provider": {
    "@type": "MedicalOrganization",
    "name": "Procordis"
  },
  "medicalSpecialty": {
    "@type": "MedicalSpecialty",
    "name": "Cardiology"
  }
}
</script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="preload" as="image" href="{{ asset('images/background02.png')|imagine_filter('page_header') }}">
{% endblock %}

{% block content %}
    {# Hero Section - Matching Specialty Style #}
    <div class="bg-[#2993C9] dark:bg-[#031219] text-primary-foreground py-20 text-center relative overflow-hidden">
        <div class="absolute inset-0 z-0 bg-cover bg-center opacity-20" style="background-image: url('{{ asset('images/background02.png')|imagine_filter('page_header') }}'); filter: grayscale(100%);"></div>
        <div class="container mx-auto px-6 relative z-10 text-center">
            
            {# Breadcrumb #}
            <nav class="flex justify-center items-center gap-2 text-sm text-primary-foreground/80 mb-6" aria-label="Breadcrumb">
                <a href="{{ path('app_home') }}" class="hover:text-white transition-colors">Início</a>
                <span class="opacity-50">/</span>
                <a href="{{ path('app_service_index') }}" class="hover:text-white transition-colors">Serviços</a>
                <span class="opacity-50">/</span>
                <span class="font-medium text-white">{{ service.title }}</span>
            </nav>

            <h1 class="font-heading text-4xl md:text-5xl font-bold mb-4" data-aos="fade-up">{{ service.title }}</h1>
            
             {% if service.description %}
                <p class="text-xl opacity-90 max-w-2xl mx-auto leading-relaxed font-light" data-aos="fade-up" data-aos-delay="100">
                    {{ service.description }}
                </p>
            {% endif %}
        </div>
    </div>

    {# Main Content Section #}
    <section class="py-16 bg-background">
        <div class="container mx-auto px-4">
            <div class="flex flex-col lg:flex-row gap-12 lg:gap-16">
                
                {# Left Column: Content #}
                <div class="lg:w-2/3 order-2 lg:order-1">
                    <div class="bg-card rounded-2xl p-6 md:p-10 shadow-sm border border-border">
                        
                        {# Main Image #}
                        {% if service.imageName %}
                            <div class="mb-10 rounded-xl overflow-hidden shadow-lg">
                                <img src="{{ vich_uploader_asset(service, 'imageFile')|imagine_filter('service_detail') }}" 
                                     alt="{{ service.title }}" 
                                     class="w-full h-auto object-cover max-h-[500px] hover:scale-105 transition-transform duration-700">
                            </div>
                        {% endif %}

                        {# Icon & Heading - Fixed Overlap #}
                        <div class="flex items-center gap-6 mb-8 pb-8 border-b border-border">
                             {% if service.icon %}
                                <div class="w-16 h-16 shrink-0 bg-primary/10 text-primary rounded-xl flex items-center justify-center">
                                    <div class="w-8 h-8">
                                        {{ service.icon|raw }}
                                    </div>
                                </div>
                            {% endif %}
                            <div>
                                <h2 class="text-2xl font-bold text-foreground mb-1">Sobre o Procedimento</h2>
                                <p class="text-muted-foreground text-sm">
                                    Detalhes completos e preparações.
                                </p>
                            </div>
                        </div>

                        {# Rich Text Content with Custom Styling #}
                        <div class="service-content text-medical-text dark:text-slate-300">
                            {{ service.content|default('<p class="text-slate-500 italic">Conteúdo em atualização.</p>')|raw }}
                        </div>
                    </div>
                </div>

                {# Right Column: Sidebar #}
                <aside class="lg:w-1/3 order-1 lg:order-2">
                    <div class="sticky top-8 space-y-8">
                        
                        {# Navigation Menu #}
                        <div class="bg-card rounded-xl shadow-sm border border-border overflow-hidden">
                            <div class="p-5 border-b border-border bg-slate-50 dark:bg-slate-800/50">
                                <h3 class="font-bold text-lg text-foreground flex items-center gap-2">
                                    Outros Serviços
                                </h3>
                            </div>
                            <div class="p-4">
                                <nav class="space-y-1">
                                    {% for other in otherServices %}
                                        <a href="{{ path('app_service_show', {slug: other.slug}) }}" 
                                           class="flex items-center justify-between p-3 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group">
                                            <span class="text-muted-foreground text-sm font-medium group-hover:text-primary transition-colors line-clamp-1">{{ other.title }}</span>
                                            <i data-lucide="chevron-right" class="w-4 h-4 text-slate-300 group-hover:text-primary shrink-0"></i>
                                        </a>
                                    {% else %}
                                        <p class="text-sm text-muted-foreground p-2">Nenhum outro serviço listado.</p>
                                    {% endfor %}
                                </nav>
                                <div class="mt-4 pt-4 border-t border-border">
                                    <a href="{{ path('app_service_index') }}" class="text-sm font-bold text-primary hover:text-primary-700 flex items-center justify-center gap-1 transition-colors">
                                        Ver todos
                                        <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        {# Contact/Warning Box - High Contrast #}
                        <div class="bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-700/50 text-amber-900 dark:text-amber-100 rounded-xl p-6 relative overflow-hidden shadow-sm">
                            <div class="relative z-10">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-10 h-10 bg-amber-100 dark:bg-amber-800/30 rounded-lg flex items-center justify-center shrink-0">
                                        <i data-lucide="info" class="w-6 h-6 text-amber-600 dark:text-amber-400"></i>
                                    </div>
                                    <h3 class="font-bold text-lg leading-tight text-amber-900 dark:text-amber-100">Atendimento via Encaminhamento</h3>
                                </div>
                                
                                <p class="text-amber-800 dark:text-amber-200/80 text-sm leading-relaxed mb-6 font-medium">
                                    Para realizar este exame, é necessário encaminhamento médico via sistema de saúde.
                                </p>
                                
                                <a href="{{ path('app_home') }}#contact" class="block w-full bg-primary text-white font-bold text-center py-3 rounded-lg hover:bg-primary/90 transition-colors shadow-sm text-sm">
                                    Fale Conosco
                                </a>
                            </div>
                        </div>

                    </div>
                </aside>

            </div>
        </div>
    </section>

    {# Custom CSS for HTML content (Matches Specialty) #}
    <style>
        .service-content h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-foreground);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--color-primary);
        }
        .service-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--color-foreground);
            margin-top: 1.25rem;
            margin-bottom: 0.75rem;
        }
        .service-content p {
            margin-bottom: 1rem;
            line-height: 1.75;
        }
        .service-content ul, .service-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            list-style-type: disc;
        }
        .service-content li {
            margin-bottom: 0.5rem;
        }
        .service-content a {
            color: var(--color-primary);
            text-decoration: underline;
        }
        .service-content a:hover {
            text-decoration: none;
        }
        .service-content strong {
            font-weight: 600;
            color: var(--color-foreground);
        }
        .service-content img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
    </style>
{% endblock %}
