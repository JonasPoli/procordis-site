{% extends 'layouts/pixel_perfect.html.twig' %}

{% block body %}
    {# TopBar #}
    <div class="bg-topbar-bg text-primary-foreground py-2 text-sm hidden md:block">
      <div class="container mx-auto flex justify-between items-center">
        <div class="flex items-center gap-6">
          <div class="flex items-center gap-2">
            <i data-lucide="map-pin" class="w-4 h-4 text-primary"></i>
            <a href="https://www.google.com/maps/search/?api=1&query={{ generalData.address|default('Av. Queiroz Filho, 685 - Vila Sedenho, Araraquara - SP')|url_encode }}" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">
                Localização: {{ generalData.address|default('Av. Queiroz Filho, 685 - Vila Sedenho, Araraquara - SP') }}
            </a>
          </div>
          <div class="flex items-center gap-2">
            <i data-lucide="mail" class="w-4 h-4 text-primary"></i>
            <a href="mailto:{{ generalData.email|default('secretaria@procordis.org.br') }}" class="hover:text-primary transition-colors">
                Email: {{ generalData.email|default('secretaria@procordis.org.br') }}
            </a>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <div class="flex items-center gap-2">
            <i data-lucide="phone" class="w-4 h-4 text-primary"></i>
            <a href="tel:{{ generalData.phone|default('(16) 3397-4625') }}" class="hover:text-primary transition-colors">
                {{ generalData.phone|default('(16) 3397-4625') }}
            </a>
          </div>
          <div class="flex items-center gap-3 ml-4">
            <a href="{{ generalData.facebook|default('#') }}" class="hover:text-primary transition-colors" {% if generalData.facebook %}target="_blank" rel="noopener noreferrer"{% endif %} aria-label="Facebook">
              <i data-lucide="facebook" class="w-4 h-4"></i>
            </a>
            <a href="#" class="hover:text-primary transition-colors" aria-label="Twitter">
              <i data-lucide="twitter" class="w-4 h-4"></i>
            </a>
            <a href="{{ generalData.instagram|default('#') }}" class="hover:text-primary transition-colors" {% if generalData.instagram %}target="_blank" rel="noopener noreferrer"{% endif %} aria-label="Instagram">
              <i data-lucide="instagram" class="w-4 h-4"></i>
            </a>
            <a href="#" class="hover:text-primary transition-colors" aria-label="LinkedIn">
              <i data-lucide="linkedin" class="w-4 h-4"></i>
            </a>
            <span class="w-px h-4 bg-primary-foreground/20"></span>
            <button class="theme-toggle-btn hover:text-primary transition-colors" aria-label="Toggle theme">
              <i data-lucide="sun" class="w-4 h-4 theme-toggle-sun hidden"></i>
              <i data-lucide="moon" class="w-4 h-4 theme-toggle-moon"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    {# Header #}
    <header class="bg-background/95 backdrop-blur-sm sticky top-0 z-50 border-b border-border" x-data="{ isMenuOpen: false }">
      <div class="container mx-auto py-4">
        <div class="flex items-center justify-between">
          {# Logo #}
          <a href="{{ path('app_home') }}" class="flex items-center gap-2">
                <img src="{{ asset('images/logo.svg') }}" alt="Logo Procordis" class="h-12 w-auto" width="180" height="48"> 
          </a>

          {# Desktop Menu #}
          <nav class="hidden lg:flex items-center gap-8">
              <a href="{{ path('app_home') }}" class="flex items-center gap-1 transition-colors font-medium {{ app.request.get('_route') == 'app_home' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Início</a>
              <a href="{{ path('app_about') }}" class="flex items-center gap-1 transition-colors font-medium {{ app.request.get('_route') == 'app_about' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Quem Somos</a>
              
                  <a href="{{ path('app_service_index') }}" class="flex items-center gap-1 transition-colors font-medium {{ app.request.get('_route') starts with 'app_service' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Serviços</a>
                  <a href="{{ path('app_news') }}" class="flex items-center gap-1 transition-colors font-medium {{ app.request.get('_route') starts with 'app_news' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Notícias</a>
                  <a href="{{ path('app_transparency_index') }}" class="flex items-center gap-1 transition-colors font-medium {{ app.request.get('_route') starts with 'app_transparency' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Transparência</a>
                  
                  {% if app.request.get('_route') == 'app_home' %}
                      <a href="#specialists" class="flex items-center gap-1 text-medical-text hover:text-primary transition-colors font-medium">Corpo Clínico</a>
                      <a href="#contact" class="flex items-center gap-1 text-medical-text hover:text-primary transition-colors font-medium">Contato</a>
                  {% else %}
                       <a href="{{ path('app_home') }}#specialists" class="flex items-center gap-1 text-medical-text hover:text-primary transition-colors font-medium">Corpo Clínico</a>
                       <a href="{{ path('app_home') }}#contact" class="flex items-center gap-1 text-medical-text hover:text-primary transition-colors font-medium">Contato</a>
                  {% endif %}
              </nav>

          {# Mobile Menu Button #}
          <button class="lg:hidden p-2" @click="isMenuOpen = !isMenuOpen" aria-label="Abrir Menu">
            <i x-show="!isMenuOpen" data-lucide="menu" class="w-6 h-6"></i>
            <i x-show="isMenuOpen" data-lucide="x" class="w-6 h-6" style="display: none;"></i>
          </button>
        </div>

        {# Mobile Menu #}
        <nav class="lg:hidden mt-4 pb-4 border-t border-border pt-4" x-show="isMenuOpen" style="display: none;">
            <div class="flex flex-col gap-4">
                <a href="{{ path('app_home') }}" class="flex items-center justify-between transition-colors font-medium {{ app.request.get('_route') == 'app_home' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Início</a>
                <a href="{{ path('app_about') }}" class="flex items-center justify-between transition-colors font-medium {{ app.request.get('_route') == 'app_about' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Quem Somos</a>
                <a href="{{ path('app_service_index') }}" class="flex items-center justify-between transition-colors font-medium {{ app.request.get('_route') starts with 'app_service' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Serviços</a>
                <a href="{{ path('app_news') }}" class="flex items-center justify-between transition-colors font-medium {{ app.request.get('_route') starts with 'app_news' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Notícias</a>
                <a href="{{ path('app_transparency_index') }}" class="flex items-center justify-between transition-colors font-medium {{ app.request.get('_route') starts with 'app_transparency' ? 'text-primary' : 'text-medical-text hover:text-primary' }}">Transparência</a>
                
                {% if app.request.get('_route') == 'app_home' %}
                    <a href="#specialists" class="flex items-center justify-between text-medical-text hover:text-primary transition-colors font-medium">Corpo Clínico</a>
                    <a href="#contact" class="flex items-center justify-between text-medical-text hover:text-primary transition-colors font-medium">Contato</a>
                {% else %}
                    <a href="{{ path('app_home') }}#specialists" class="flex items-center justify-between text-medical-text hover:text-primary transition-colors font-medium">Corpo Clínico</a>
                    <a href="{{ path('app_home') }}#contact" class="flex items-center justify-between text-medical-text hover:text-primary transition-colors font-medium">Contato</a>
                {% endif %}
            </div>
        </nav>
      </div>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    {# Footer #}
    <footer class="bg-topbar-bg text-primary-foreground">
      {# Newsletter Bar #}
      <div class="border-b border-primary-foreground/20">
        <div class="container mx-auto py-6">
          <div class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="md:w-1/2">
                <h3 class="text-xl font-bold mb-1">Fique por dentro das novidades</h3>
                <p class="text-primary-foreground/70 text-sm">Receba dicas de saúde e notícias da Procordis.</p>
            </div>
            <form class="flex w-full md:w-1/2" x-data="{
                email: '',
                loading: false,
                async submitNewsletter() {
                    this.loading = true;
                    try {
                        const response = await fetch('/api/newsletter', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email: this.email })
                        });
                        const result = await response.json();
                        if (response.ok) {
                            Swal.fire({
                                title: 'Inscrição Confirmada!',
                                text: 'Obrigado por se inscrever na nossa newsletter.',
                                icon: 'success',
                                confirmButtonColor: '#0ea5e9'
                            });
                            this.email = '';
                        } else {
                            if (result.error && result.error.includes('Duplicate')) {
                                Swal.fire({
                                    title: 'Já Inscrito', 
                                    text: 'Este e-mail já faz parte da nossa lista.', 
                                    icon: 'info',
                                    confirmButtonColor: '#0ea5e9'
                                });
                            } else {
                                Swal.fire({
                                    title: 'Erro', 
                                    text: result.error || 'Não foi possível realizar a inscrição.', 
                                    icon: 'error',
                                    confirmButtonColor: '#0ea5e9'
                                });
                            }
                        }
                    } catch (e) {
                         Swal.fire({
                            title: 'Erro de Conexão', 
                            text: 'Verifique sua internet e tente novamente.', 
                            icon: 'error',
                            confirmButtonColor: '#0ea5e9'
                        });
                    } finally {
                        this.loading = false;
                    }
                }
            }" @submit.prevent="submitNewsletter">
              <input type="email" x-model="email" placeholder="Seu melhor e-mail" required class="flex-1 px-4 py-3 bg-primary-foreground/10 border border-primary-foreground/20 text-primary-foreground placeholder:text-primary-foreground/50 focus:outline-none focus:border-primary rounded-l-lg">
              <button type="submit" class="px-6 py-3 bg-primary text-primary-foreground hover:bg-primary-light transition-colors rounded-r-lg font-medium" :disabled="loading">
                <span x-show="!loading">Inscrever</span>
                <span x-show="loading" class="text-xs">...</span>
              </button>
            </form>
            <div class="flex items-center gap-4">
              <a href="{{ generalData.facebook|default('#') }}" class="hover:text-primary transition-colors" {% if generalData.facebook %}target="_blank" rel="noopener noreferrer"{% endif %} aria-label="Facebook"><i data-lucide="facebook" class="w-5 h-5"></i></a>
              <a href="#" class="hover:text-primary transition-colors" aria-label="Twitter"><i data-lucide="twitter" class="w-5 h-5"></i></a>
              <a href="{{ generalData.instagram|default('#') }}" class="hover:text-primary transition-colors" {% if generalData.instagram %}target="_blank" rel="noopener noreferrer"{% endif %} aria-label="Instagram"><i data-lucide="instagram" class="w-5 h-5"></i></a>
              <a href="#" class="hover:text-primary transition-colors" aria-label="LinkedIn"><i data-lucide="linkedin" class="w-5 h-5"></i></a>
            </div>
          </div>
        </div>
      </div>

      {# Main Footer #}
      <div class="container mx-auto py-12">
        <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-8">
          {# About #}
          <div>
            <div class="flex items-center gap-2 mb-6">
              <a href="{{ path('app_home') }}" class="flex items-center gap-2">
                    <img src="{{ asset('images/logo.svg') }}" alt="Logo Procordis" class="h-12 w-auto" width="180" height="48"> 
              </a>
            </div>
            <p class="text-primary-foreground/70 text-sm leading-relaxed mb-4">
              Ambulatório Cardíaco de referência em Araraquara. Tecnologia avançada e atendimento humanizado para cuidar do seu coração.
            </p>
            <div class="space-y-2 text-sm">
              <div class="flex items-center gap-2">
                <i data-lucide="map-pin" class="w-4 h-4 text-primary"></i>
                <a href="https://www.google.com/maps/search/?api=1&query={{ generalData.address|default('Av. Queiroz Filho, 685 - Vila Sedenho, Araraquara - SP, 14806-010')|url_encode }}" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">
                    {{ generalData.address|default('Av. Queiroz Filho, 685 - Vila Sedenho, Araraquara - SP, 14806-010') }}
                </a>
              </div>
              <div class="flex items-center gap-2">
                <i data-lucide="phone" class="w-4 h-4 text-primary"></i>
                <a href="tel:{{ generalData.phone|default('(16) 3397-4625') }}" class="hover:text-primary transition-colors">
                    {{ generalData.phone|default('(16) 3397-4625') }}
                </a>
              </div>
              <div class="flex items-center gap-2">
                <i data-lucide="mail" class="w-4 h-4 text-primary"></i>
                <a href="mailto:{{ generalData.email|default('secretaria@procordis.org.br') }}" class="hover:text-primary transition-colors">
                    {{ generalData.email|default('secretaria@procordis.org.br') }}
                </a>
              </div>
            </div>
          </div>

          {# Quick Links #}
          <div>
            <h4 class="text-lg font-bold mb-6">Links Rápidos</h4>
            <ul class="space-y-3">
                <li><a href="{{ path('app_home') }}" class="text-primary-foreground/70 hover:text-white hover:translate-x-1 transition-all duration-300 text-sm block">Início</a></li>
                <li><a href="{{ path('app_about') }}" class="text-primary-foreground/70 hover:text-white hover:translate-x-1 transition-all duration-300 text-sm block">Quem Somos</a></li>
                <li><a href="{{ path('app_news') }}" class="text-primary-foreground/70 hover:text-white hover:translate-x-1 transition-all duration-300 text-sm block">Notícias</a></li>
                <li><a href="{{ path('app_home') }}#specialities" class="text-primary-foreground/70 hover:text-white hover:translate-x-1 transition-all duration-300 text-sm block">Corpo Clínico</a></li>
                <li><a href="{{ path('app_home') }}#contact" class="text-primary-foreground/70 hover:text-white hover:translate-x-1 transition-all duration-300 text-sm block">Contato</a></li>
            </ul>
          </div>

          {# Specialties #}
          <div>
            <h4 class="text-lg font-bold mb-6">Especialidades</h4>
            <ul class="space-y-3">
                {{ render(controller('App\\Controller\\PartialController::footerServices')) }}
                <li><a href="{{ path('app_service_index') }}" class="text-primary hover:text-white hover:translate-x-1 transition-all duration-300 text-sm font-medium flex items-center gap-1">Ver todas <i data-lucide="arrow-right" class="w-3 h-3"></i></a></li>
            </ul>
          </div>

          {# Opening Hours #}
          <div>
            <h4 class="text-lg font-bold mb-6">Horário de Atendimento</h4>
            <div class="space-y-3 text-sm text-primary-foreground/70">
              <div class="flex justify-between">
                <span>Segunda - Sexta</span>
                <span>07:00 - 18:00</span>
              </div>
               <div class="flex justify-between">
                <span>Sábado</span>
                <span>Fechado</span>
              </div>
               <div class="flex justify-between">
                <span>Domingo</span>
                <span>Fechado</span>
              </div>
            </div>
          </div>
        </div>
      </div>

          {# Bottom Bar #}
      <div class="border-t border-primary-foreground/20">
        <div class="container mx-auto py-4">
          <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-primary-foreground/70">
            <div class="flex flex-wrap justify-center gap-4 md:gap-6">
                <a href="{{ path('app_transparency_index') }}" class="hover:text-white transition-colors duration-300">Transparência</a>
                {{ render(controller('App\\Controller\\PartialController::footerPages')) }}
            </div>
            <p>© {{ 'now'|date('Y') }} Associação Procordis. Todos os direitos reservados.</p>
          </div>
        </div>
      </div>
    </footer>
{% endblock %}
